<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
      <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <title>NSFWDetector</title>
</head>
<body>
    <div class="container">
        <form action="/checkImg" method="post" enctype="multipart/form-data" id="upload">
            <div class="form-group">
              <label for="image">Chọn ảnh</label>
              <input type="file" class="form-control" id="image" placeholder="Chọn ảnh" name="image">
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    </div>
    <script>
        function handleSubmit(event) {
          const form = event.currentTarget;
          const url = new URL(form.action);
          const formData = new FormData(form);
          const searchParams = new URLSearchParams(formData);

          const fetchOptions = {
            method: form.method,
          };

          if (form.method.toLowerCase() === 'post') {
            if (form.enctype === 'multipart/form-data') {
              fetchOptions.body = formData;
            } else {
              fetchOptions.body = searchParams;
            }
          } else {
            url.search = searchParams;
          }

          fetch(url, fetchOptions).then(response => response.json())
              .then(response => {
                  console.log(response.status)
                  if(response.status === "Oke"){
                      alert("Ảnh phù hợp")
                  }else {
                      alert("Ảnh chưa phù hợp")
                  }
              })
              .catch((err) => {
                  alea(err)
                  console.log(err)
              });

          event.preventDefault();
        }
        const form = document.querySelector('form');
        form.addEventListener('submit', handleSubmit);
    </script>
</body>
</html>